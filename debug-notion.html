
</html>>
</body>cript;
    </s
        })mStorage();dFro      loa> {
      ', () =oadedtLen('DOMContistenerventLcument.addE       do
 载时自动尝试加载配置 // 页面加       
           }
   ccess');
  存已清除', 'suatus', '✅ 缓debugStatus('   updateSt      );
   nfig'm('notion_coIteemoveorage.r localSt      {
     he()  clearCacction fun
            }
          
    };
         tack)or.s errugOutput',put('debdateOut        up        );
 'error'sage,ror.mes错误: ' + erus', '❌ 最小查询Stattus('debug  updateSta             {
  tch (error)     } ca
             }        
    );                   2)}`
 null,gify(data,ON.strin错误响应:\n${JS      `                  
ent + nt).textCougOutput'entById('deblemt.getEmen docu                     
  utput', ebugOutput('dteO   upda                  'error');
 '❌ 最小查询失败',bugStatus',de('eStatus     updat          
        } else {          );
                    }`
    null, 2)fy(data,ON.stringi响应:\n${JS  `                   t + 
   ).textContentput'ugOuId('debentByent.getElem    docum             ', 
       ebugOutput('deOutput     updat            
   s');, 'succes询成功'tus', '✅ 最小查ugSta'debateStatus(     upd         ) {
      esponse.ok (r      if                    
);
      on(ponse.jsait resata = aw    const d          
          
        );   }    )
         Bodyuest(reqtringify.sON body: JS                   },
                    n'
tion/jsolica'apppe': ent-Ty'Cont                      06-28',
  on': '2022-rsiVeNotion-          '           `,
   piKey}entConfig.arrBearer ${cution': `uthoriza        'A           {
     eaders:      h           
    hod: 'POST',      met            ery`, {
  eId}/qudatabasonfig.currentCes/${/v1/databascomon.otis://api.n`httpch( = await fett response       cons        
                \n\n`);
 l, 2)} nuly,stBodify(requengN.stri${JSO, `请求体:\nOutput''debugeOutput(pdat u                    
                };
         
  1page_size:                    {
  equestBody = r const          
     何过滤器包含任，不 // 最简单的查询              try {
    
                  
   nfo');.', 'i最小查询.., '🔄 正在测试Status'debugtatus('    updateS           
   
         }    urn;
           ret         ');
 ', 'error', '❌ 请先测试配置'debugStatusStatus(  update           
   abaseId) {.datfigentCon!curr.apiKey || figurrentConif (!c          {
  ) y(tMinimalQuertion tesuncsync f
        a            }
    }
          ck);
  .statput', erroreOuturtput('structeOuda      up         );
  'error'essage,or.mrr查错误: ' + eus', '❌ 结构检ructureStats('sttupdateSta    u            
ch (error) {      } cat   }
                    2));
l,ta, nulfy(daN.stringiut', JSOOutp('structureuteOutp   updat                 ror');
', 'er❌ 无法获取数据库结构Status', 'ructureus('stateStat       upd           else {
    }           fo);
    ructureIn, stutput'structureO('tput   updateOu                
                
          }          `;
     .type}\ne}: ${prop`- ${namInfo += urestruct                       es)) {
 pertiproes(entrif Object., prop] oame [n for (const                  
 :\n';nfo += '字段详情eI  structur        
                      
           }                 s');
ucces构检查通过', 's库结数据tatus', '✅ ureSus('struct  updateStat                   n\n`;
   字段都存在\= `✅ 所有必需fo +uctureIn       str                 e {
     } els           
    rror');h} 个字段`, 'eFields.lengtmissing构不完整，缺少 ${️ 数据库结tatus', `⚠eS'structuratus(    updateSt                   \n\n`;
 n(', ')}ngFields.joisi{mis必需字段: $`❌ 缺少= o +nfctureI      stru             {
      0)  >.lengthingFieldsmissif (                 
                   `;
    , ')}\n\nn('Fields.joiistingngth}): ${exlds.leFiexisting{e `现有字段 ($ureInfo +=truct           s     \n`;
    未知'} || '.plain_textle[0]?a.tit数据库标题: ${dattureInfo = ` struc     let                   
             ));
   ldcludes(fieinlds.existingFie(field => !terfilds.ielequiredF= relds missingFinst           co          es);
operti.keys(prObjectds = ielistingF const ex                  e'];
 Time', 'Readished DatPublblished', ''Puags',  'Ttegory',', 'Camary'Sum,  = ['Title'dsedFielnst requir    co         es;
       ta.propertirties = daconst prope          
          se.ok) { if (respon         
                 );
     json(response.ait a = awonst dat      c         
               });
                      }
            28'
    -06- '2022on-Version':       'Noti                 iKey}`,
aprentConfig.rer ${curea`Bzation': hori     'Aut                  : {
 headers               
     d}`, {.databaseIntConfigurrees/${cbas1/data.com/v.notion`https://apietch(se = await fnst respon   co      {
             try     
       ');
       ..', 'info数据库结构.us', '🔄 正在检查ructureStats('steStatu      updat
              
          }  rn;
         retu        or');
   试配置', 'err请先测'❌ atus', Structureatus('stpdateSt     u          baseId) {
 ig.datacurrentConfpiKey || !ntConfig.a  if (!curre       ure() {
   aseStruct checkDatabync function   as        
          }
  }
          ;
   or.stack)t', errutpuctionOnneut('copdateOutp      u    
      error');.message, '误: ' + error, '❌ 查询错nStatus'tioconnecdateStatus('    up  
          ) {tch (error} ca            }
      
          , null, 2));(data.stringifytput', JSONonnectionOut('cupdateOutpu               );
     or'询失败', 'errtus', '❌ 查nectionStaus('con  updateStat           
         } else {            l, 2));
  ata, nul.stringify(dJSONtput', ectionOuut('conntppdateOu u            
       '); 'success} 条记录`,engthesults.l找到 ${data.r 查询成功， `✅',nStatuss('connectiopdateStatu   u           ) {
      nse.okespo       if (r       
                on();
  sponse.jsait rea = awdatonst        c            
       });
                    Body)
  equestngify(r.stri JSON   body:                    },
          '
       sonplication/jap-Type': ''Content                     
   22-06-28',ion': '20tion-Vers 'No                  }`,
     g.apiKeyrrentConfirer ${cueaon': `Bthorizati        'Au           s: {
     der     hea               : 'POST',
method                    ry`, {
seId}/quefig.databa{currentCones/$databascom/v1/i.notion.(`https://apetch= await fresponse     const                   
        };
                _size: 5
      page             {
    questBody =   const re         
    try {                 

       ', 'info');在测试查询... 正nStatus', '🔄onnectioeStatus('c updat             
              }

          return;              r');
 'erro 请先测试配置',nStatus', '❌ioctnnetus('codateSta        up
        aseId) {ig.databcurrentConfKey || !ntConfig.apicurre(!  if 
          () {uerystQunction te    async f   
       }
     
       }   
       r.stack);rroutput', etionOonneceOutput('c       updat       rror');
  'eor.message,  ' + err'❌ 数据库访问错误:nStatus', ctios('conne updateStatu               {
r)  catch (erro         }
         }        
  ll, 2));ta, nugify(daN.strinut', JSOctionOutpnnetput('codateOu   up          ;
       rror')访问失败', 'e '❌ 数据库onStatus',s('connectitu   updateSta                else {
        }     );
     , null, 2)y(dataSON.stringifput', JnOut'connectiopdateOutput(        u     
       ccess');据库访问成功', 'su'✅ 数tatus', ectionSStatus('conn    update               k) {
 .onse if (respo           
                ();
    e.jsonwait respons aonst data =         c          
             });
                 }
           
        6-28'on': '2022-0ersi-V   'Notion                    
 `,y}.apiKerentConfigearer ${cur: `Bthorization'   'Au                  
   eaders: {          h      
    eId}`, {ig.databas{currentConfes/$bas/dataotion.com/v1s://api.nfetch(`httpit ponse = awat res    cons         try {
                  

         );o'', 'inf据库访问... 正在测试数atus', '🔄St'connectiondateStatus(      up            
   }
               
eturn;       r         error');
先测试配置', ', '❌ 请ionStatus's('connectpdateStatu           u   d) {
  seIig.databaurrentConfapiKey || !crentConfig.if (!cur      {
      tabase() tDaction tesync fun      as        
  
        }
    }
        ck);ta error.stput',tionOuput('connecpdateOut         u     
  or');, 'erressagerror.m 连接错误: ' + enStatus', '❌s('connectiodateStatu          upr) {
      rro (ech       } cat             }
       ull, 2));
 , ntastringify(daON. JSonOutput','connectiateOutput(pd           u   r');
      接失败', 'erro '❌ API连',tusnectionStaon'cs(dateStatu   up              lse {
       } e           
 );null, 2)fy(data, tringiut', JSON.sionOutp'connectput(ateOut    upd              ss');
  , 'succe API连接成功's', '✅atunectionStons('cupdateStatu                  se.ok) {
    if (respon          
               );
     ponse.json( resawaitdata = nst       co              
      
          });            }
                 
   -06-28'022ion': '2n-Vers    'Notio                    iKey}`,
ntConfig.aprecurrer ${Bea': `onAuthorizati           '            {
  ers:   head                 
/me', {v1/userson.com//api.notittps:/ait fetch('honse = awst resp        con
        ry {          t      
  
      , 'info');...'连接在测试s', '🔄 正tuctionStaatus('conneupdateSt           
          }
          rn;
          retu           ror');
试配置', 'ers', '❌ 请先测ectionStatu'conns(dateStatuup              
  ey) {tConfig.apiK (!curren  if      ) {
    nnection(stCo tec functionsyn        a      
      }
  
  ');uccess式验证通过', 'sus', '✅ 配置格'configStatus(tateS    updat    ;
    seId }ataba dey, apiKntConfig = {      curre   
      }
                  ;
     return              ror');
', 'er2位字符）应为3正确（e ID长度不tabas'⚠️ Datatus', nfigSeStatus('co    updat            32) {
 ngth !==abaseId.le     if (dat
                 }
             return;
          
       , 'error');头）'et_开（应以secr不正确 API Key格式可能'⚠️tus', ('configStapdateStatus       u   {
       _'))'secretrtsWith(.sta (!apiKey    if    验证格式
           //   
               }
           rn;
       retu         ');
 置信息', 'error填写完整的配', '❌ 请usigStatus('confeStatdat         up      
 Id) {se| !databaey |f (!apiK       i              
m();
   alue.tri.vd')eIabasentById('datgetElemdocument.Id = nst database  co
          .trim();value').d('apiKeyByIlementcument.getE = donst apiKey co       
    Config() { testoncti      fun  
        

        }   };
         , 'error')messagerror. ' + e置失败:加载配Status', '❌ 'configs( updateStatu        {
        h (error)      } catc         }
     );
        'error'存储中没有找到配置', atus', '⚠️ s('configStpdateStatu   u              {
         } else
           uccess');存储加载', 's '✅ 配置已从us',tat'configSdateStatus(       up         ;
    d || ''aseIconfig.databe = aseId').valuById('databementument.getEl         doc          ey || '';
 ig.apiKue = conf).valKey'tById('apigetElemenocument.  d               ;
   (stored)parsefig = JSON.cont         cons        {
    stored) if (                ;
n_config')('notioemtorage.getItlocalStored =   const s          {
          try  {
      ge()omStoraoadFr function l   
                    }
ck';
= 'blolay disple.sty   element.         ntent;
ontent = coextCelement.t            ntId);
(elemeyIdgetElementBocument.= delement    const {
         content) (elementId, ut updateOutpnction
        fu      }
         pe}`;
 tus ${ty`staame = t.classN  elemen    
      ge;t = messatextContenelement.          
  entId);lemId(elementBy.getEt = documentenem   const el         {
 = 'info') ype te,agmess(elementId, tatustion updateS      func
            };
  
    d: ''baseI     data     y: '',
     apiKe         {
fig = currentConet       l>
  ipt <scr

   
    </div>    </div>
          </div>
       </ul>             
  >参数</li查过滤器和排序i>请求格式错误：检          <l         需字段</li>
 在：检查数据库是否包含必>字段不存     <li       
        到数据库</li>添加：确保集成已   <li>权限不足           >
      符）</li位字数据库ID格式正确（32误：确认atabase ID错    <li>D            </li>
    集成是否正确创建检查NotionI Key无效：    <li>AP                ul>
         <     g></p>
  案：</stron和解决方常见问题ng>p><stro <              ">
 ize: 14px;cc; font-s="color: #cns" stylesuggestiov id="      <didiv>
      ">5. 修复建议</"debug-titlelass= <div c          ">
 ctiondebug-sev class="    <di          
 div>
   </
      /div>y: none;"><la"dispstyle=-output" ss="debugcla" debugOutputid=" <div 
           iv>绪</do">调试工具就"status infs" class=debugStatu<div id="           </button>
 除缓存che()">清="clearCa" onclickebug-button"d class=     <button      on>
 /butt测试最小查询<">malQuery()"testMiniclick=tton" on"debug-bu class=  <button          /button>
">调试请求格式<bugRequest()"de onclick=bug-button"ass="decl  <button        试</div>
   请求调>4. ug-title"lass="deb    <div c">
        ionctbug-se"dev class=       <di      
   </div>
        >
ne;"></divlay: no"disp" style=outputdebug-ass="" cltputtructureOuiv id="s <d         结构</div>
  数据库o">点击按钮检查nf="status iclassus" uctureStatdiv id="str   <        on>
 tt出所有属性</bus()">列istPropertienclick="lutton" oug-bdebton class="      <but
      on>构</butt)">检查数据库结tructure(baseSatak="checkDlicn" oncuttoug-beb="dutton class    <b
        </div>构检查. 数据库结e">3ebug-titl"d class=   <div         on">
ebug-secticlass="d      <div   
  
      </div>        "></div>
ay: none;sple="di" stylutg-outpbu"dess=t" clautpunectionO"con<div id=           </div>
 ">点击按钮开始测试status infoss="us" clanectionStatid="con <div 
           button>测试查询</uery()">ck="testQn" onclittog-buclass="debuon butt   <        n>
 问</butto">测试数据库访abase()ck="testDat" onclittonbug-ebu class="d  <button      ton>
    测试连接</but()">tConnectionesick="t" onclg-buttondebu"on class=     <butt    >
   测试</divI连接2. APle">tit="debug-ss <div cla        ">
   ebug-section"ddiv class=  <
          div>
    </>
        信息</div入Notion配置info">请输"status tus" class=figStaiv id="con        <dton>
    >从存储加载</butStorage()"loadFromonclick="on" utts="debug-bas <button cl       on>
    测试配置</buttig()">nfCotestonclick="on" buttug-"debon class=     <butt        </div>
         ">
  base IDtion Data"输入Noaceholder=t" plfig-inpuss="con" claaseIdd="datab="text" iinput type          <     l>
  ID:</labese>Databa  <label                <div>
   v>
       di   </>
         API Key"n r="输入Notioceholdelanput" ponfig-i" class="c"apiKeyord" id=="passwpe <input ty           label>
    y:</ Kebel>API   <la           v>
    <di        >
  检查</div">1. 配置tletig-lass="debudiv c   <      
   tion">secug-"debs=iv clas     <d      
   题</p>
  n API连接问>诊断和修复Notiocc;"r: #cr; coloenten: c-alige="text  <p styl
       调试工具</h1>n APItio">🔧 Nonter; cetext-align:fff; r: #00fyle="colo     <h1 stiner">
   "conta class=<div>
    ad>
<body</heyle>
    </st       }
.2);
  255, 255, 0 rgba(0, 0 0 2pxshadow: 0        box-    
f;00fff-color: #  border    one;
      e: n    outlin        focus {
g-input:onfi.c 
             }
   
       gin: 5px 0;      mar2px;
      size: 1t- fon         ospace;
  ', monrier New'Couy: il  font-fam         e;
  whitr:      colo      ius: 6px;
r-radorde          b
  ); 255, 0.355, 255,id rgba(2px solr: 1rde        bo1);
    255, 0., 255, a(255gbound: rgr      back    g: 10px;
  paddin       00%;
        width: 1{
         put onfig-in    .c      
    
       }fff;
   olor: #00f     c);
       5, 0.3, 255, 25id rgba(0px solder: 1      bor     55, 0.1);
 0, 255, 2rgba(ackground:      b
       .info {    .status 
              }
6b6b;
      #ffor:col         
   );0, 0.3(255, 0, d rgbapx solier: 1rd bo         ;
   0.1)(255, 0, 0,round: rgba      backgor {
      tatus.err     .s     
   }
   0;
        r: #00ff0   colo   .3);
      , 255, 0, 0id rgba(0px sol: 1     border    
    0.1);, 0, 255 rgba(0,ckground:ba      
       {atus.successst  .
      
                };
ze: 14px font-si           0;
rgin: 10px     ma        dius: 6px;
r-ra      borde      g: 10px;
   paddin        s {
    .statu   
     
        }  e-wrap;
   : pr-space white
           y: auto;rflow-ove       px;
     : 400 max-height       ;
    -size: 12px        font
    pace;monoser New', ly: 'Courimi     font-fa    x 0;
    margin: 15p
           ding: 15px;  pad       s: 8px;
   radiu border-         , 0.2);
  2555, 255, 25gba( solid r 1pxborder:          0.5);
  ba(0, 0, 0,  rgd: backgroun    {
       utput bug-o.de              
  
  }     3);
  255, 0.(0, 255,gba 20px rw: 0 6pxx-shadobo            x);
slateY(-2pform: tranrans t      {
     utton:hover ug-b .deb 
            }
      ase;
     all 0.3s eransition:      t5px;
         margin: ;
         weight: 600     font-
       ze: 14px;    font-si      ointer;
  r: p    curso        s: 8px;
er-radiu      bord
      10px 20px;g: din         padne;
    border: no           #000;
 color: 
            #0080ff);00ffff,eg, #radient(45d-garround: line backg           tton {
-bu  .debug
      }
        
        m: 15px;n-botto margi          t: 600;
  font-weigh   ;
        ize: 18px-s    font        : #00ffff;
color           g-title {
    .debu   
        }
     0;
      20px  margin:    px;
       ing: 20add p         s: 12px;
  r-radiu  borde        );
  55, 255, 0.3, 2olid rgba(0 s 1pxder:         bor;
   05) 255, 0., 255,ba(255 rgnd:   backgrou      {
   ug-section eb       .d   
     }
     ;
    torgin: 0 au    ma
        000px;max-width: 1      
      ner { .contai  
       
      
        }: 1.6;ighthee-     lin    x;
   0pding: 2   pad   ce;
      ', monospa'Courier Newily:  font-fam        e;
   whit   color: ;
         d: #0a0a0akgroun         bacody {
   
        b>    <style具</title>
PI 调试工e>Notion A>
    <titl.0"cale=1al-sti, inidth=device-wint="widthontewport" c"vieame=    <meta n"UTF-8">
harset=    <meta cead>
<hh-CN">
ang="zml>
<html l<!DOCTYPE ht