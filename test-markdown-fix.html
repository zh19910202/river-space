<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdownæ¸²æŸ“ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            background: #0a0a0a;
            color: white;
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .test-section {
            background: rgba(26, 26, 46, 0.8);
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        
        .markdown-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.8;
            font-size: 16px;
            word-wrap: break-word;
        }
        
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #00ffff;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .markdown-content pre {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid rgba(0, 255, 255, 0.2);
        }
        
        .markdown-content code {
            background: rgba(0, 255, 255, 0.1);
            color: #00ffff;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .markdown-content pre code {
            background: none;
            padding: 0;
        }
        
        .markdown-content a {
            color: #00ffff;
            text-decoration: underline;
        }
        
        .markdown-content blockquote {
            border-left: 4px solid #00ffff;
            padding-left: 1em;
            margin: 1.5em 0;
            font-style: italic;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .test-button {
            background: linear-gradient(45deg, #00ffff, #0080ff);
            color: black;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        
        .result-box {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 3px;
            margin: 5px;
            display: inline-block;
        }
        
        .status.success { background: rgba(0, 255, 0, 0.2); color: #00ff00; }
        .status.error { background: rgba(255, 0, 0, 0.2); color: #ff6666; }
        .status.warning { background: rgba(255, 255, 0, 0.2); color: #ffff66; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Markdownæ¸²æŸ“ä¿®å¤æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•å†…å®¹:</h2>
        <textarea id="markdownInput" rows="15" style="width: 100%; background: #222; color: white; padding: 10px; border: 1px solid #444; border-radius: 5px;">
# è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ ‡é¢˜

è¿™æ˜¯ä¸€æ®µåŒ…å«**ç²—ä½“æ–‡å­—**å’Œ*æ–œä½“æ–‡å­—*çš„æ™®é€šæ®µè½ã€‚

## ä»£ç ç¤ºä¾‹

```javascript
function testFunction() {
    console.log("Hello, World!");
    return "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•°";
}
```

è¿™é‡Œæœ‰ä¸€äº›`å†…è”ä»£ç `ç¤ºä¾‹ã€‚

## åˆ—è¡¨ç¤ºä¾‹

- ç¬¬ä¸€ä¸ªåˆ—è¡¨é¡¹
- ç¬¬äºŒä¸ªåˆ—è¡¨é¡¹
- ç¬¬ä¸‰ä¸ªåˆ—è¡¨é¡¹

## å¼•ç”¨ç¤ºä¾‹

> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å—
> å®ƒåŒ…å«å¤šè¡Œå†…å®¹

## é“¾æ¥ç¤ºä¾‹

[è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é“¾æ¥](https://example.com)

## æ›´å¤šæ ¼å¼

è¿™æ˜¯ä¸€æ®µåŒ…å«å¤šç§æ ¼å¼çš„æ–‡å­—ï¼š**ç²—ä½“**ã€*æ–œä½“*ã€`ä»£ç `å’Œ[é“¾æ¥](https://test.com)ã€‚

---

è¿™æ˜¯åˆ†å‰²çº¿ä¸‹æ–¹çš„å†…å®¹ã€‚
        </textarea>
        
        <button class="test-button" onclick="testContentParser()">æµ‹è¯•ContentParser</button>
        <button class="test-button" onclick="testBlogComponent()">æµ‹è¯•BlogComponent</button>
        <button class="test-button" onclick="runFullTest()">å®Œæ•´æµ‹è¯•</button>
        <button class="test-button" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ:</h2>
        <div id="testResults">ç­‰å¾…æµ‹è¯•...</div>
    </div>
    
    <div class="test-section">
        <h2>æ¸²æŸ“æ•ˆæœ:</h2>
        <div id="renderResult" class="markdown-content result-box">
            ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹æ¸²æŸ“æ•ˆæœ...
        </div>
    </div>
    
    <div class="test-section">
        <h2>HTMLæºç :</h2>
        <pre id="htmlSource" class="result-box" style="white-space: pre-wrap; font-size: 12px;">ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹HTMLæºç ...</pre>
    </div>

    <script type="module">
        let contentParser = null;
        let blogComponent = null;
        
        // æ·»åŠ çŠ¶æ€æ˜¾ç¤ºå‡½æ•°
        function addStatus(container, message, type = 'info') {
            const status = document.createElement('div');
            status.className = `status ${type}`;
            status.textContent = message;
            container.appendChild(status);
        }
        
        // åˆå§‹åŒ–
        async function initializeComponents() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<h3>ğŸ”„ åˆå§‹åŒ–ç»„ä»¶...</h3>';
            
            try {
                // å¯¼å…¥ContentParser
                const { ContentParser } = await import('./src/utils/contentParser.js');
                contentParser = new ContentParser();
                addStatus(results, 'âœ… ContentParseråˆå§‹åŒ–æˆåŠŸ', 'success');
                
                // å¯¼å…¥BlogComponent
                const { BlogComponent } = await import('./src/components/BlogComponent.js');
                const mockContainer = document.createElement('div');
                blogComponent = new BlogComponent(mockContainer);
                addStatus(results, 'âœ… BlogComponentåˆå§‹åŒ–æˆåŠŸ', 'success');
                
                return true;
            } catch (error) {
                addStatus(results, `âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
                console.error('åˆå§‹åŒ–é”™è¯¯:', error);
                return false;
            }
        }
        
        // æµ‹è¯•ContentParser
        window.testContentParser = async function() {
            const results = document.getElementById('testResults');
            const renderResult = document.getElementById('renderResult');
            const htmlSource = document.getElementById('htmlSource');
            const input = document.getElementById('markdownInput').value;
            
            results.innerHTML = '<h3>ğŸ§ª æµ‹è¯•ContentParser...</h3>';
            
            if (!contentParser) {
                const initialized = await initializeComponents();
                if (!initialized) return;
            }
            
            try {
                console.log('æµ‹è¯•è¾“å…¥:', input);
                
                const startTime = performance.now();
                const htmlResult = contentParser.parseMarkdown(input);
                const endTime = performance.now();
                
                addStatus(results, `âœ… ContentParserè§£ææˆåŠŸ (${(endTime - startTime).toFixed(2)}ms)`, 'success');
                addStatus(results, `ğŸ“Š è¾“å…¥é•¿åº¦: ${input.length}, è¾“å‡ºé•¿åº¦: ${htmlResult.length}`, 'info');
                
                // æ£€æŸ¥HTMLæ ‡ç­¾
                const tags = ['h1', 'h2', 'p', 'strong', 'em', 'code', 'pre', 'ul', 'li', 'blockquote', 'a'];
                const foundTags = tags.filter(tag => htmlResult.includes(`<${tag}`));
                const missingTags = tags.filter(tag => !htmlResult.includes(`<${tag}`));
                
                addStatus(results, `ğŸ·ï¸ æ‰¾åˆ°æ ‡ç­¾: ${foundTags.join(', ')}`, 'success');
                if (missingTags.length > 0) {
                    addStatus(results, `âš ï¸ ç¼ºå¤±æ ‡ç­¾: ${missingTags.join(', ')}`, 'warning');
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰HTMLè½¬ä¹‰
                const hasEscaping = htmlResult.includes('&lt;') || htmlResult.includes('&gt;') || htmlResult.includes('&amp;');
                if (hasEscaping) {
                    addStatus(results, 'âŒ æ£€æµ‹åˆ°HTMLè½¬ä¹‰é—®é¢˜', 'error');
                } else {
                    addStatus(results, 'âœ… æ²¡æœ‰HTMLè½¬ä¹‰é—®é¢˜', 'success');
                }
                
                // æ˜¾ç¤ºç»“æœ
                renderResult.innerHTML = htmlResult;
                htmlSource.textContent = htmlResult;
                
            } catch (error) {
                addStatus(results, `âŒ ContentParseræµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                console.error('ContentParseræµ‹è¯•é”™è¯¯:', error);
            }
        };
        
        // æµ‹è¯•BlogComponent
        window.testBlogComponent = async function() {
            const results = document.getElementById('testResults');
            const renderResult = document.getElementById('renderResult');
            const htmlSource = document.getElementById('htmlSource');
            const input = document.getElementById('markdownInput').value;
            
            results.innerHTML = '<h3>ğŸ§ª æµ‹è¯•BlogComponent...</h3>';
            
            if (!blogComponent) {
                const initialized = await initializeComponents();
                if (!initialized) return;
            }
            
            try {
                // å…ˆç”¨ContentParserå¤„ç†å†…å®¹
                const processedContent = contentParser.parseMarkdown(input);
                addStatus(results, 'âœ… å†…å®¹é¢„å¤„ç†å®Œæˆ', 'success');
                
                // åˆ›å»ºæ¨¡æ‹Ÿåšå®¢å¯¹è±¡
                const mockBlog = {
                    id: 'test-blog-123',
                    title: 'Markdownæ¸²æŸ“æµ‹è¯•æ–‡ç« ',
                    category: 'æŠ€æœ¯',
                    publishDate: '2025-01-20',
                    readTime: '5åˆ†é’Ÿ'
                };
                
                // åˆ›å»ºæ¨¡æ‹Ÿå®¹å™¨
                const mockContainer = document.createElement('div');
                mockContainer.className = 'blog-detail-content';
                document.body.appendChild(mockContainer);
                
                // è°ƒç”¨BlogComponentçš„æ›´æ–°æ–¹æ³•
                blogComponent.updateDetailPageContent(mockBlog, processedContent);
                
                addStatus(results, 'âœ… BlogComponent.updateDetailPageContentè°ƒç”¨æˆåŠŸ', 'success');
                
                // æ£€æŸ¥æ¸²æŸ“ç»“æœ
                const articleContent = mockContainer.querySelector('.markdown-content');
                if (articleContent) {
                    const renderedHtml = articleContent.innerHTML;
                    
                    addStatus(results, `ğŸ“Š æ¸²æŸ“å†…å®¹é•¿åº¦: ${renderedHtml.length}`, 'info');
                    
                    // æ£€æŸ¥HTMLæ ‡ç­¾æ˜¯å¦æ­£ç¡®æ¸²æŸ“
                    const hasProperTags = renderedHtml.includes('<h1>') && 
                                         renderedHtml.includes('<strong>') && 
                                         renderedHtml.includes('<code>');
                    
                    if (hasProperTags) {
                        addStatus(results, 'âœ… HTMLæ ‡ç­¾æ­£ç¡®æ¸²æŸ“', 'success');
                    } else {
                        addStatus(results, 'âŒ HTMLæ ‡ç­¾æ¸²æŸ“å¼‚å¸¸', 'error');
                    }
                    
                    // æ£€æŸ¥æ˜¯å¦æœ‰è½¬ä¹‰
                    const hasEscaping = renderedHtml.includes('&lt;') || renderedHtml.includes('&gt;');
                    if (hasEscaping) {
                        addStatus(results, 'âŒ æ£€æµ‹åˆ°HTMLè½¬ä¹‰é—®é¢˜', 'error');
                    } else {
                        addStatus(results, 'âœ… æ²¡æœ‰HTMLè½¬ä¹‰é—®é¢˜', 'success');
                    }
                    
                    renderResult.innerHTML = renderedHtml;
                    htmlSource.textContent = renderedHtml;
                } else {
                    addStatus(results, 'âŒ æœªæ‰¾åˆ°.markdown-contentå…ƒç´ ', 'error');
                }
                
                // æ¸…ç†æ¨¡æ‹Ÿå®¹å™¨
                setTimeout(() => mockContainer.remove(), 5000);
                
            } catch (error) {
                addStatus(results, `âŒ BlogComponentæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                console.error('BlogComponentæµ‹è¯•é”™è¯¯:', error);
            }
        };
        
        // å®Œæ•´æµ‹è¯•
        window.runFullTest = async function() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<h3>ğŸš€ è¿è¡Œå®Œæ•´æµ‹è¯•...</h3>';
            
            const initialized = await initializeComponents();
            if (!initialized) return;
            
            addStatus(results, 'å¼€å§‹å®Œæ•´æµ‹è¯•æµç¨‹...', 'info');
            
            // æµ‹è¯•ContentParser
            await testContentParser();
            
            // ç­‰å¾…ä¸€ä¸‹å†æµ‹è¯•BlogComponent
            setTimeout(async () => {
                await testBlogComponent();
                
                // ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
                setTimeout(() => {
                    const statusElements = results.querySelectorAll('.status');
                    const successCount = results.querySelectorAll('.status.success').length;
                    const errorCount = results.querySelectorAll('.status.error').length;
                    const warningCount = results.querySelectorAll('.status.warning').length;
                    
                    const reportDiv = document.createElement('div');
                    reportDiv.innerHTML = `
                        <h4>ğŸ“Š æµ‹è¯•æŠ¥å‘Š</h4>
                        <div class="status success">âœ… æˆåŠŸ: ${successCount}</div>
                        <div class="status ${errorCount > 0 ? 'error' : 'success'}">${errorCount > 0 ? 'âŒ' : 'âœ…'} é”™è¯¯: ${errorCount}</div>
                        <div class="status ${warningCount > 0 ? 'warning' : 'success'}">${warningCount > 0 ? 'âš ï¸' : 'âœ…'} è­¦å‘Š: ${warningCount}</div>
                        <div class="status ${errorCount === 0 ? 'success' : 'error'}">
                            ${errorCount === 0 ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Markdownæ¸²æŸ“ä¿®å¤æˆåŠŸï¼' : 'ğŸ”§ ä»éœ€è¦è§£å†³ä¸€äº›é—®é¢˜'}
                        </div>
                    `;
                    results.appendChild(reportDiv);
                }, 500);
            }, 1000);
        };
        
        window.clearResults = function() {
            document.getElementById('testResults').innerHTML = 'ç­‰å¾…æµ‹è¯•...';
            document.getElementById('renderResult').innerHTML = 'ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹æ¸²æŸ“æ•ˆæœ...';
            document.getElementById('htmlSource').textContent = 'ç‚¹å‡»æµ‹è¯•æŒ‰é’®æŸ¥çœ‹HTMLæºç ...';
        };
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åˆå§‹åŒ–
        window.addEventListener('load', () => {
            console.log('ğŸ› ï¸ Markdownæ¸²æŸ“ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('ä½¿ç”¨è¯´æ˜:');
            console.log('1. ç‚¹å‡»"æµ‹è¯•ContentParser"æµ‹è¯•markdownè§£æ');
            console.log('2. ç‚¹å‡»"æµ‹è¯•BlogComponent"æµ‹è¯•åšå®¢ç»„ä»¶æ¸²æŸ“');
            console.log('3. ç‚¹å‡»"å®Œæ•´æµ‹è¯•"è¿è¡Œæ‰€æœ‰æµ‹è¯•');
        });
    </script>
</body>
</html>